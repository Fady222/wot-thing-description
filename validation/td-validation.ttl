@prefix : <http://www.w3.org/ns/td-validation#> .
@prefix td: <https://www.w3.org/2019/wot/td#> .
@prefix jsonschema: <https://www.w3.org/2019/wot/json-schema#> .
@prefix wotsec: <https://www.w3.org/2019/wot/security#> .
@prefix hctl: <https://www.w3.org/2019/wot/hypermedia#> .
@prefix dc: <http://purl.org/dc/elements/1.1/> .
@prefix vs: <http://www.w3.org/2003/06/sw-vocab-status/ns#> .
@prefix owl: <http://www.w3.org/2002/07/owl#> .
@prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> .
@prefix xml: <http://www.w3.org/XML/1998/namespace> .
@prefix xsd: <http://www.w3.org/2001/XMLSchema#> .
@prefix foaf: <http://xmlns.com/foaf/0.1/> .
@prefix prov: <http://www.w3.org/ns/prov#> .
@prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#> .
@prefix skos: <http://www.w3.org/2004/02/skos/core#> .
@prefix vann: <http://purl.org/vocab/vann/> .
@prefix dcterms: <http://purl.org/dc/terms/> .
@prefix schema: <http://schema.org> .
@prefix sh: <http://www.w3.org/ns/shacl#> .

:ThingShape a sh:NodeShape ;
    sh:targetClass td:Thing ;
    skos:definition """An abstraction of a physical or a virtual entity whose
          metadata and interfaces are described by a WoT Thing
          Description, whereas a virtual entity is the composition
          of one or more Things."""^^rdf:HTML ;
    sh:closed false ;
    sh:order 1 ;
    sh:property [
        sh:path dcterms:title ;
        skos:definition """Provides a human-readable title (e.g., display
                a text for UI representation) based on a default
                language."""^^rdf:HTML ;
        sh:minCount 1 ;
        sh:order 1 ;
    ] ;
    sh:property [
        sh:path dcterms:description ;
        skos:definition """Provides additional (human-readable)
                information based on a default language."""^^rdf:HTML ;
        sh:order 3 ;
    ] ;
    sh:property [
        sh:path td:versionInfo ;
        skos:definition """Provides version information."""^^rdf:HTML ;
        sh:node :VersionInfoShape ;
        sh:order 5 ;
    ] ;
    sh:property [
        sh:path dcterms:created ;
        skos:definition """Provides information when the TD instance was
                created."""^^rdf:HTML ;
        sh:datatype xsd:dateTime ;
        sh:maxCount 1 ;
        sh:order 6 ;
    ] ;
    sh:property [
        sh:path dcterms:modified ;
        skos:definition """Provides information when the TD instance was
                last modified."""^^rdf:HTML ;
        sh:datatype xsd:dateTime ;
        sh:maxCount 1 ;
        sh:order 7 ;
    ] ;
    sh:property [
        sh:path td:supportContact ;
        skos:definition """Provides information about the TD maintainer as
                URI scheme (e.g., <code>mailto</code>
                [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc6068" title="The 'mailto' URI Scheme">RFC6068</a></cite>],
                <code>tel</code> [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc3966" title="The tel URI for Telephone Numbers">RFC3966</a></cite>],
                <code>https</code>)."""^^rdf:HTML ;
        sh:maxCount 1 ;
        sh:order 8 ;
    ] ;
    sh:property [
        sh:path [
            sh:alternativePath (
                td:hasPropertyAffordance
                td:hasActionAffordance
                td:hasEventAffordance
            )
        ] ;
        sh:node :InteractionAffordanceShape ;
        sh:minCount 1
    ] ;
    sh:property [
        sh:path td:hasPropertyAffordance ;
        skos:definition """All Property-based <a href="#dfn-interaction-affordance" class="internalDFN" data-link-type="dfn">Interaction Affordances</a>
                  of the Thing."""^^rdf:HTML ;
        sh:node :PropertyAffordanceShape ;
        sh:order 10 ;
    ] ;
    sh:property [
        sh:path td:hasActionAffordance ;
        skos:definition """All Action-based <a href="#dfn-interaction-affordance" class="internalDFN" data-link-type="dfn">Interaction Affordances</a>
                  of the Thing."""^^rdf:HTML ;
        sh:node :ActionAffordanceShape ;
        sh:order 11 ;
    ] ;
    sh:property [
        sh:path td:hasEventAffordance ;
        skos:definition """All Event-based <a href="#dfn-interaction-affordance" class="internalDFN" data-link-type="dfn">Interaction Affordances</a>
                  of the Thing."""^^rdf:HTML ;
        sh:node :EventAffordanceShape ;
        sh:order 12 ;
    ] ;
    sh:property [
        sh:path td:hasLink ;
        skos:definition """Provides Web links to arbitrary resources that
                relate to the specified Thing Description."""^^rdf:HTML ;
        sh:node :LinkShape ;
        sh:order 13 ;
    ] ;
    sh:property [
        sh:path td:hasForm ;
        skos:definition """Set of form hypermedia controls that describe how
                  an operation can be performed. Forms are
                  serializations of Protocol Bindings. In this
                  version of TD, all operations that can be
                  described at the Thing level are concerning how
                  to interact with the Thing's <a href="#propertyaffordance">Properties</a> collectively
                  at once."""^^rdf:HTML ;
        sh:node :FormShape ;
        sh:order 14 ;
    ] ;
    sh:property [
        sh:path td:hasSecurityConfiguration ;
        skos:definition """Set of security definition names, chosen from
                those defined in <code>securityDefinitions</code>.
                These must all be satisfied for access to
                resources."""^^rdf:HTML ;
        sh:minCount 1 ;
        sh:node :SecuritySchemeShape ;
        sh:order 15 ;
    ] .
    
:InteractionAffordanceShape a sh:NodeShape ;
    sh:targetClass td:InteractionAffordance ;
    skos:definition """Metadata of a Thing that shows the possible choices to
          <a href="#dfn-consumer" class="internalDFN" data-link-type="dfn">Consumers</a>, thereby suggesting
          how <a href="#dfn-consumer" class="internalDFN" data-link-type="dfn">Consumers</a> may interact with the
          Thing. There are many types of potential affordances, but
          <abbr title="World Wide Web Consortium">W3C</abbr> WoT
          defines three types of Interaction Affordances:
          Properties, Actions, and Events."""^^rdf:HTML ;
    sh:closed false ;
    sh:order 2 ;
    sh:property [
        sh:path dcterms:title ;
        sh:order 1 ;
    ] ;
    sh:property [
        sh:path dcterms:description ;
        sh:order 3 ;
    ] ;
    sh:property [
        sh:path td:hasForm ;
        sh:minCount 1 ;
        sh:node :FormShape ;
        sh:order 5 ;
    ] ;
    sh:property [
        sh:path td:hasUriTemplateSchema ;
        skos:definition """Define URI template variables as collection
                based on DataSchema declarations."""^^rdf:HTML ;
        sh:node :DataSchemaShape ;
        sh:order 6 ;
    ] .

:PropertyAffordanceShape a sh:NodeShape ;
    sh:targetClass td:PropertyAffordance ;
    skos:definition """An Interaction Affordance that exposes state of the
          Thing. This state can then be retrieved (read) and
          optionally updated (write). Things can also choose to
          make Properties observable by pushing the new state after
          a change."""^^rdf:HTML ;
    sh:closed false ;
    sh:order 3 ;
    sh:property [
        sh:path td:isObservable ;
        skos:definition """A hint that indicates whether Servients hosting
                the Thing and Intermediaries should provide a
                Protocol Binding that supports the
                <code>observeproperty</code> operation for this
                Property."""^^rdf:HTML ;
        sh:datatype xsd:boolean ;
        sh:maxCount 1 ;
    ] .
    
:ActionAffordanceShape a sh:NodeShape ;
    sh:targetClass td:ActionAffordance ;
    skos:definition """An Interaction Affordance that allows to invoke a
          function of the Thing, which manipulates state (e.g.,
          toggling a lamp on or off) or triggers a process on the
          Thing (e.g., dim a lamp over time)."""^^rdf:HTML ;
    sh:closed false ;
    sh:order 4 ;
    sh:property [
        sh:path td:hasInputSchema ;
        skos:definition """Used to define the input data schema of the
                Action."""^^rdf:HTML ;
        sh:node :DataSchemaShape ;
        sh:maxCount 1 ;
        sh:order 1 ;
    ] ;
    sh:property [
        sh:path td:hasOutputSchema ;
        skos:definition """Used to define the output data schema of the
                Action."""^^rdf:HTML ;
        sh:node :DataSchemaShape ;
        sh:maxCount 1 ;
        sh:order 2 ;
    ] ;
    sh:property [
        sh:path td:isSafe ;
        skos:definition """Signals if the Action is safe (=true) or not.
                Used to signal if there is no internal state (cf.
                resource state) is changed when invoking an Action.
                In that case responses can be cached as
                example."""^^rdf:HTML ;
        sh:datatype xsd:boolean ;
        sh:defaultValue false ;
        sh:maxCount 1 ;
        sh:order 3 ;
    ] ;
    sh:property [
        sh:path td:isIdempotent ;
        skos:definition """Indicates whether the Action is idempotent
                (=true) or not. Informs whether the Action can be
                called repeatedly with the same result, if present,
                based on the same input."""^^rdf:HTML ;
        sh:datatype xsd:boolean ;
        sh:defaultValue false ;
        sh:maxCount 1 ;
        sh:order 4 ;
    ] .
    
:EventAffordanceShape a sh:NodeShape ;
    sh:targetClass td:EventAffordance ;
    skos:definition """An Interaction Affordance that describes an event
          source, which asynchronously pushes event data to
          <a href="#dfn-consumer" class="internalDFN" data-link-type="dfn">Consumers</a> (e.g., overheating
          alerts)."""^^rdf:HTML ;
    sh:closed false ;
    sh:order 5 ;
    sh:property [
        sh:path td:hasSubscriptionSchema ;
        skos:definition """Defines data that needs to be passed upon
                subscription, e.g., filters or message format for
                setting up Webhooks."""^^rdf:HTML ;
        sh:node :DataSchemaShape ;
        sh:maxCount 1 ;
        sh:order 1 ;
    ] ;
    sh:property [
        sh:path td:hasNotificationSchema ;
        skos:definition """Defines the data schema of the Event instance
                messages pushed by the Thing."""^^rdf:HTML ;
        sh:node :DataSchemaShape ;
        sh:maxCount 1 ;
        sh:order 2 ;
    ] ;
    sh:property [
        sh:path td:hasCancellationSchema ;
        skos:definition """Defines any data that needs to be passed to
                cancel a subscription, e.g., a specific message to
                remove a Webhook."""^^rdf:HTML ;
        sh:node :DataSchemaShape ;
        sh:maxCount 1 ;
        sh:order 3 ;
    ] .

:VersionInfoShape a sh:NodeShape ;
    sh:targetClass td:VersionInfo ;
    skos:definition """Metadata of a Thing that provides version information
          about the TD document. If required, additional version
          information such as firmware and hardware version (term
          definitions outside of the TD namespace) can be extended
          via the <a href="#dfn-context-ext" class="internalDFN" data-link-type="dfn">TD Context Extension</a>
          mechanism."""^^rdf:HTML ;
    sh:closed false ;
    sh:order 8 ;
    sh:property [
        sh:path td:instance ;
        skos:definition """Provides a version indicator of this TD
                instance."""^^rdf:HTML ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
    ] .

:FormShape a sh:NodeShape ;
    sh:targetClass hctl:Form ;
    skos:definition """A form can be viewed as a statement of "To perform an
          <b><em>operation type</em></b> operation on <b><em>form
          context</em></b>, make a <b><em>request method</em></b>
          request to <b><em>submission target</em></b>" where the
          optional <b><em>form fields</em></b> may further describe
          the required request. In Thing Descriptions, the
          <b><em>form context</em></b> is the surrounding Object,
          such as Properties, Actions, and Events or the Thing
          itself for meta-interactions."""^^rdf:HTML ;
    sh:closed false ;
    sh:order 7 ;
    sh:property [
        sh:path hctl:hasTarget ;
        skos:definition """Target IRI of a link or submission target of a
                form."""^^rdf:HTML ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:nodeKind sh:IRI ;
        sh:order 2 ;
    ] ;
    sh:property [
        sh:path hctl:forContentType ;
        skos:definition """Assign a content type based on a media type
                (e.g., <code>text/plain</code>) and potential
                parameters (e.g., <code>charset=utf-8</code>) for
                the media type [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc2046" title="Multipurpose Internet Mail Extensions (MIME) Part Two: Media Types">RFC2046</a></cite>]."""^^rdf:HTML ;
        sh:datatype xsd:string ;
        sh:defaultValue "application/json"^^xsd:string ;
        sh:order 3 ;
    ] ;
    sh:property [
        sh:path hctl:forContentCoding ;
        skos:definition """Content coding values indicate an encoding
                transformation that has been or can be applied to a
                representation. Content codings are primarily used
                to allow a representation to be compressed or
                otherwise usefully transformed without losing the
                identity of its underlying media type and without
                loss of information. Examples of content coding
                include "gzip", "deflate", etc. ."""^^rdf:HTML ;
        sh:datatype xsd:string ;
        sh:order 4 ;
    ] ;
    sh:property [
        sh:path hctl:returns ;
        skos:definition """This optional term can be used if, e.g., the
                output communication metadata differ from input
                metadata (e.g., output contentType differ from the
                input contentType). The response name contains
                metadata that is only valid for the response
                messages."""^^rdf:HTML ;
        sh:node :ExpectedResponseShape ;
        sh:order 8 ;
    ] ;
    sh:property [
        sh:path hctl:hasOperationType ;
        skos:definition """Indicates the semantic intention of performing
                the operation(s) described by the form. For
                example, the Property interaction allows get and
                set operations. The protocol binding may contain a
                form for the get operation and a different form for
                the set operation. The op attribute indicates which
                form is for which and allows the client to select
                the correct form for the operation required. op can
                be assigned one or more interaction verb(s) each
                representing a semantic intention of an
                operation."""^^rdf:HTML ;
        sh:in (
            td:readProperty
            td:writeProperty
            td:observeProperty
            td:unobserveProperty
            td:invokeAction
            td:subscribeEvent
            td:unsubscribeEvent
            td:readAllProperties
            td:writeAllProperties
            td:readMultipleProperties
            td:writeMultipleProperties
        );
        sh:order 1 ;
    ] ;
    sh:property [
        sh:path hctl:forSubProtocol ;
        skos:definition """Indicates the exact mechanism by which an
                interaction will be accomplished for a given
                protocol when there are multiple options. For
                example, for HTTP and Events, it indicates which of
                several available mechanisms should be used for
                asynchronous notifications such as long polling
                (<code>longpoll</code>), WebSub [<cite><a class="bibref" data-link-type="biblio" href="#bib-websub" title="WebSub">websub</a></cite>]
                (<code>websub</code>), Server-Sent Events
                (<code>sse</code>) [<cite><a class="bibref" data-link-type="biblio" href="#bib-html" title="HTML Standard">html</a></cite>] (also known as
                EventSource). Please note that there is no
                restriction on the subprotocol selection and other
                mechanisms can also be announced by this
                subprotocol term."""^^rdf:HTML ;
        sh:maxCount 1 ;
        skos:example (
            "longpoll"
            "websub"
            "sse"
        ) ;
        sh:order 5 ;
    ] ;
    sh:property [
        sh:path td:hasSecurityConfiguration ;
        sh:node :SecuritySchemeShape ;
        sh:order 6 ;
    ] ;
    sh:property [
        sh:path wotsec:scopes ;
        skos:definition """Set of authorization scope identifiers provided
                as an array. These are provided in tokens returned
                by an authorization server and associated with
                forms in order to identify what resources a client
                may access and how. The values associated with a
                form should be chosen from those defined in an
                <code>OAuth2SecurityScheme</code> active on that
                form."""^^rdf:HTML ;
        sh:datatype xsd:string ;
        sh:order 7 ;
    ] .
    
:LinkShape a sh:NodeShape ;
    sh:targetClass hctl:Link ;
    skos:definition """A link can be viewed as a statement of the form
          "<b><em>link context</em></b> has a <b><em>relation
          type</em></b> resource at <b><em>link target</em></b>",
          where the optional <b><em>target attributes</em></b> may
          further describe the resource."""^^rdf:HTML ;
    sh:closed false ;
    sh:order 6 ;
    sh:property [
        sh:path hctl:hasTarget ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:nodeKind sh:IRI ;
        sh:order 1 ;
    ] ;
    sh:property [
        sh:path hctl:hintsAtMediaType ;
        skos:definition """Target attribute providing a hint indicating
                what the media type [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc2046" title="Multipurpose Internet Mail Extensions (MIME) Part Two: Media Types">RFC2046</a></cite>]
                of the result of dereferencing the link should
                be."""^^rdf:HTML ;
        sh:datatype xsd:string ;
        sh:order 2 ;
    ] ;
    sh:property [
        sh:path hctl:hasRelationType ;
        skos:definition """A link relation type identifies the semantics
                of a link."""^^rdf:HTML ;
        sh:nodeKind sh:IRI ; # TODO could be relaxed
        sh:order 3 ;
    ] ;
    sh:property [
        sh:path hctl:hasAnchor ;
        skos:definition """Overrides the link context (by default the
                Thing itself identified by its <code>id</code>)
                with the given URI or IRI."""^^rdf:HTML ;
        sh:node sh:IRI ;
        sh:maxCount 1 ;
        sh:order 4 ;
    ] .

:ExpectedResponseShape a sh:NodeShape ;
    sh:targetClass hctl:ExpectedResponse ;
    skos:definition """Communication metadata describing the expected
          response message."""^^rdf:HTML ;
    sh:closed false ;
    sh:order 9 ;
     sh:property [
        sh:path hctl:forContentType ;
        skos:definition """Assign a content type based on a media type
                (e.g., <code>text/plain</code>) and potential
                parameters (e.g., <code>charset=utf-8</code>) for
                the media type [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc2046" title="Multipurpose Internet Mail Extensions (MIME) Part Two: Media Types">RFC2046</a></cite>]."""^^rdf:HTML ;
        sh:datatype xsd:string ;
        sh:minCount 1 ;
    ] .

:SecuritySchemeShape a sh:NodeShape ;
    sh:targetClass wotsec:SecurityScheme ;
    skos:definition """Metadata describing the configuration of a security
          mechanism. <span class="rfc2119-assertion" id="td-security-scheme-name">The value assigned to the name
          <code>scheme</code> <em class="rfc2119" title="MUST">MUST</em> be defined within a <a href="#dfn-vocab" class="internalDFN" data-link-type="dfn">Vocabulary</a>
          included in the <a href="#dfn-thing-description" class="internalDFN" data-link-type="dfn">Thing Description</a>,
          either in the standard <a href="#dfn-vocab" class="internalDFN" data-link-type="dfn">Vocabulary</a> defined
          in <a href="#sec-vocabulary-definition" class="sec-ref">§&nbsp;<bdi class="secno">5.</bdi> TD
          Information Model</a> or in a <a href="#dfn-context-ext" class="internalDFN" data-link-type="dfn">TD Context
          Extension</a>.</span>"""^^rdf:HTML ;
    sh:closed false ;
    sh:order 1 ;
    sh:property [
        sh:path rdf:type ;
        skos:definition """Identification of the security mechanism being
                configured."""^^rdf:HTML ;
        # FIXME declare securityDefinitions as @included
        # sh:minCount 1 ;
        sh:in (
            wotsec:NoSecurityScheme
            wotsec:BasicSecurityScheme
            wotsec:CertSecurityScheme
            wotsec:DigestSecurityScheme
            wotsec:BearerSecurityScheme
            wotsec:PoPSecurityScheme
            wotsec:PSKSecurityScheme
            wotsec:PublicSecurityScheme
            wotsec:OAuth2SecurityScheme
            wotsec:APIKeySecurityScheme
        );
        sh:order 1 ;
    ] ;
    sh:property [
        sh:path dcterms:description ;
        sh:order 2 ;
    ] ;
    sh:property [
        sh:path wotsec:proxy ;
        skos:definition """URI of the proxy server this security
                configuration provides access to. If not given, the
                corresponding security configuration is for the
                endpoint."""^^rdf:HTML ;
        sh:nodeKind sh:IRI ;
        sh:maxCount 1 ;
        sh:order 4 ;
    ] .

:NoSecuritySchemeShape a sh:NodeShape ;
    sh:targetClass wotsec:NoSecurityScheme ;
    skos:definition """A security configuration corresponding to identified
          by the <a href="#dfn-vocab-term" class="internalDFN" data-link-type="dfn">Vocabulary Term</a>
          <code>nosec</code> (i.e., <code>"scheme":
          "nosec"</code>), indicating there is no authentication or
          other mechanism required to access the resource."""^^rdf:HTML ;
    sh:closed false ;
    sh:order 2 .

:BasicSecuritySchemeShape a sh:NodeShape ;
    sh:targetClass wotsec:BasicSecurityScheme ;
    skos:definition """Basic Authentication [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc7617" title="The 'Basic' HTTP Authentication Scheme">RFC7617</a></cite>]
          security configuration identified by the <a href="#dfn-vocab-term" class="internalDFN" data-link-type="dfn">Vocabulary Term</a> <code>basic</code> (i.e.,
          <code>"scheme": "basic"</code>), using an unencrypted
          username and password. This scheme should be used with
          some other security mechanism providing confidentiality,
          for example, TLS."""^^rdf:HTML ;
    sh:closed false ;
    sh:order 3 ;
    sh:property [
        sh:path wotsec:in ;
        skos:definition """Specifies the location of security
                authentication information."""^^rdf:HTML ;
        sh:datatype xsd:string ;
        sh:maxCount 1 ;
        sh:in (
          "header"
          "query"
          "body"
          "cookie"
        );
        sh:defaultValue "header"^^xsd:string ;
        sh:order 1 ;
    ] ;
    sh:property [
        sh:path wotsec:name ;
        skos:definition """Name for query, header, or cookie
                parameters."""^^rdf:HTML ;
        sh:datatype xsd:string ;
        sh:maxCount 1 ;
        sh:order 2 ;
    ] .

:DigestSecuritySchemeShape a sh:NodeShape ;
    sh:targetClass wotsec:DigestSecurityScheme ;
    skos:definition """Digest Access Authentication [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc7616" title="HTTP Digest Access Authentication">RFC7616</a></cite>]
          security configuration identified by the <a href="#dfn-vocab-term" class="internalDFN" data-link-type="dfn">Vocabulary Term</a> <code>digest</code> (i.e.,
          <code>"scheme": "digest"</code>). This scheme is similar
          to basic authentication but with added features to avoid
          man-in-the-middle attacks."""^^rdf:HTML ;
    sh:closed false ;
    sh:order 4 ;
    sh:property [
        sh:path wotsec:qop ;
        skos:definition """Quality of protection."""^^rdf:HTML ;
        sh:datatype xsd:string ;
        sh:maxCount 1 ;
        sh:in (
          "auth"
          "auth-int"
        );
        sh:defaultValue "auth"^^xsd:string ;
        sh:order 1 ;
    ] ;
    sh:property [
        sh:path wotsec:in ;
        sh:datatype xsd:string ;
        sh:maxCount 1 ;
        sh:in (
          "header"
          "query"
          "body"
          "cookie"
        );
        sh:defaultValue "header"^^xsd:string ;
        sh:order 2 ;
    ] ;
    sh:property [
        sh:path wotsec:name ;
        sh:datatype xsd:string ;
        sh:maxCount 1 ;
        sh:order 3 ;
    ] .

:APIKeySecuritySchemeShape a sh:NodeShape ;
    sh:targetClass wotsec:APIKeySecurityScheme ;
    skos:definition """API key authentication security configuration
          identified by the <a href="#dfn-vocab-term" class="internalDFN" data-link-type="dfn">Vocabulary Term</a>
          <code>apikey</code> (i.e., <code>"scheme":
          "apikey"</code>). This is for the case where the access
          token is opaque and is not using a standard token
          format."""^^rdf:HTML ;
    sh:closed false ;
    sh:order 5 ;
    sh:property [
        sh:path wotsec:in ;
        sh:datatype xsd:string ;
        sh:maxCount 1 ;
        sh:in (
          "header"
          "query"
          "body"
          "cookie"
        );
        sh:defaultValue "query"^^xsd:string ;
        sh:order 1 ;
    ] ;
    sh:property [
        sh:path wotsec:name ;
        sh:datatype xsd:string ;
        sh:maxCount 1 ;
        sh:order 2 ;
    ] .

:BearerSecuritySchemeShape a sh:NodeShape ;
    sh:targetClass wotsec:BearerSecurityScheme ;
    skos:definition """Bearer Token [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc6750" title="The OAuth 2.0 Authorization Framework: Bearer Token Usage">RFC6750</a></cite>]
          security configuration identified by the <a href="#dfn-vocab-term" class="internalDFN" data-link-type="dfn">Vocabulary Term</a> <code>bearer</code> (i.e.,
          <code>"scheme": "bearer"</code>) for situations where
          bearer tokens are used independently of OAuth2. If the
          <code>oauth2</code> scheme is specified it is not
          generally necessary to specify this scheme as well as it
          is implied. For <code>format</code>, the value
          <code>jwt</code> indicates conformance with
          [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc7519" title="JSON Web Token (JWT)">RFC7519</a></cite>],
          <code>jws</code> indicates conformance with
          [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc7797" title="JSON Web Signature (JWS) Unencoded Payload Option">RFC7797</a></cite>],
          <code>cwt</code> indicates conformance with
          [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc8392" title="CBOR Web Token (CWT)">RFC8392</a></cite>], and
          <code>jwe</code> indicates conformance with
          [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc7516" title="JSON Web Encryption (JWE)">RFC7516</a></cite>], with
          values for <code>alg</code> interpreted consistently with
          those standards. <span class="rfc2119-assertion" id="td-security-bearer-format-extensions">Other formats and
          algorithms for bearer tokens <em class="rfc2119" title="MAY">MAY</em> be specified in vocabulary
          extensions</span>."""^^rdf:HTML ;
    sh:closed false ;
    sh:order 6 ;
    sh:property [
        sh:path wotsec:authorization ;
        skos:definition """URI of the authorization server."""^^rdf:HTML ;
        sh:datatype xsd:anyURI ;
        sh:maxCount 1 ;
        sh:order 1 ;
    ] ;
    sh:property [
        sh:path wotsec:alg ;
        skos:definition """Encoding, encryption, or digest algorithm."""^^rdf:HTML ;
        sh:datatype xsd:string ;
        sh:maxCount 1 ;
        skos:example (
          "MD5" 
          "ES256"
          "ES512-256"
        );
        sh:defaultValue "ES256"^^xsd:string ;
        sh:order 2 ;
    ] ;
    sh:property [
        sh:path wotsec:format ;
        skos:definition """Specifies format of security authentication
                information."""^^rdf:HTML ;
        sh:datatype xsd:string ;
        sh:maxCount 1 ;
        skos:example (
          "jwt" 
          "cwt" 
          "jwe"
          "jws"
        );
        sh:defaultValue "jwt"^^xsd:string ;
        sh:order 3 ;
    ] ;
    sh:property [
        sh:path wotsec:in ;
        sh:datatype xsd:string ;
        sh:maxCount 1 ;
        sh:in (
          "header"
          "query"
          "body"
          "cookie"
        );
        sh:defaultValue "header"^^xsd:string ;
        sh:order 4 ;
    ] ;
    sh:property [
        sh:path wotsec:name ;
        sh:datatype xsd:string ;
        sh:maxCount 1 ;
        sh:order 5 ;
    ] .

:CertSecuritySchemeShape a sh:NodeShape ;
    sh:targetClass wotsec:CertSecurityScheme ;
    skos:definition """TODO"""^^rdf:HTML ;
    skos:editorialNote "at risk" ;
    sh:closed false ;
    sh:order 7 ;
    sh:property [
        sh:path wotsec:identity ;
        skos:definition """Identifier providing information which can be
                used for selection or confirmation."""^^rdf:HTML ;
        sh:maxCount 1 ;
        sh:datatype xsd:string ;
    ] .

:PSKSecuritySchemeShape a sh:NodeShape ;
    sh:targetClass wotsec:PSKSecurityScheme ;
    skos:definition """Pre-shared key authentication security configuration
          identified by the <a href="#dfn-vocab-term" class="internalDFN" data-link-type="dfn">Vocabulary Term</a>
          <code>psk</code> (i.e., <code>"scheme":
          "psk"</code>)."""^^rdf:HTML ;
    sh:closed false ;
    sh:order 8 ;
    sh:property [
        sh:path wotsec:identity ;
        sh:maxCount 1 ;
        sh:datatype xsd:string ;
    ] .

:PublicSecuritySchemeShape a sh:NodeShape ;
    sh:targetClass wotsec:PublicSecurityScheme ;
    skos:definition """TODO"""^^rdf:HTML ;
    skos:editorialNote "at risk" ;
    sh:closed false ;
    sh:order 9 ;
    sh:property [
        sh:path wotsec:identity ;
        sh:maxCount 1 ;
        sh:datatype xsd:string ;
    ] .

:PoPSecuritySchemeShape a sh:NodeShape ;
    sh:targetClass wotsec:PoPSecurityScheme ;
    skos:definition """TODO"""^^rdf:HTML ;
    skos:editorialNote "at risk" ;
    sh:closed false ;
    sh:order 10 ;
    sh:property [
        sh:path wotsec:authorization ;
        sh:maxCount 1 ;
        sh:nodeKind sh:IRI ;
        sh:order 1 ;
    ] ;
    sh:property [
        sh:path wotsec:alg ;
        sh:datatype xsd:string ;
        sh:maxCount 1 ;
        skos:example (
          "MD5" 
          "ES256"
          "ES512-256"
        );
        sh:defaultValue "ES256"^^xsd:string ;
        sh:order 2 ;
    ] ;
    sh:property [
        sh:path wotsec:format ;
        skos:definition """"""^^rdf:HTML ;
        sh:datatype xsd:string ;
        sh:maxCount 1 ;
        skos:example (
          "jwt" 
          "cwt" 
          "jwe"
          "jws"
        );
        sh:defaultValue "jwt"^^xsd:string ;
        sh:order 3 ;
    ] ;
    sh:property [
        sh:path wotsec:in ;
        sh:datatype xsd:string ;
        sh:maxCount 1 ;
        sh:in (
          "header"
          "query"
          "body"
          "cookie"
        );
        sh:defaultValue "header"^^xsd:string ;
        sh:order 4 ;
    ] ;
    sh:property [
        sh:path wotsec:name ;
        sh:datatype xsd:string ;
        sh:maxCount 1 ;
        sh:order 5 ;
    ] .

:OAuth2SecuritySchemeShape a sh:NodeShape ;
    sh:targetClass wotsec:OAuth2SecurityScheme ;
    skos:definition """OAuth2 authentication security configuration for
          systems conformant with [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc6749" title="The OAuth 2.0 Authorization Framework">RFC6749</a></cite>]
          and [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc8252" title="OAuth 2.0 for Native Apps">RFC8252</a></cite>],
          identified by the <a href="#dfn-vocab-term" class="internalDFN" data-link-type="dfn">Vocabulary Term</a>
          <code>oauth2</code> (i.e., <code>"scheme":
          "oauth2"</code>). <span class="rfc2119-assertion" id="td-security-oauth2-code-flow">For the <code>code</code>
          flow both <code>authorization</code> and
          <code>token</code> <em class="rfc2119" title="MUST">MUST</em> be included.</span> If no
          <code>scopes</code> are defined in the
          <code>SecurityScheme</code> then they are considered to
          be empty."""^^rdf:HTML ;
    sh:closed false ;
    sh:order 11 ;
    sh:property [
        sh:path wotsec:authorization ;
        sh:nodeKind sh:IRI ;
        sh:maxCount 1 ;
        sh:order 1 ;
    ] ;
    sh:property [
        sh:path wotsec:token ;
        skos:definition """URI of the token server."""^^rdf:HTML ;
        sh:nodeKind sh:IRI ;
        sh:maxCount 1 ;
        sh:order 2 ;
    ] ;
    sh:property [
        sh:path wotsec:refresh ;
        skos:definition """URI of the refresh server."""^^rdf:HTML ;
        sh:nodeKind sh:IRI ;
        sh:maxCount 1 ;
        sh:order 3 ;
    ] ;
    sh:property [
        sh:path wotsec:scopes ;
        skos:definition """Set of authorization scope identifiers provided
                as an array. These are provided in tokens returned
                by an authorization server and associated with
                forms in order to identify what resources a client
                may access and how. The values associated with a
                form should be chosen from those defined in an
                <code>OAuth2SecurityScheme</code> active on that
                form."""^^rdf:HTML ;
        sh:datatype xsd:string ;
        sh:order 4 ;
    ] ;
    sh:property [
        sh:path wotsec:flow ;
        skos:definition """Authorization flow."""^^rdf:HTML ;
        sh:datatype xsd:string ;
        sh:maxCount 1 ;
        skos:example (
#            "implicit" 
#            "password" 
#            "client" 
            "code"
        );
        sh:minCount 1 ;
        sh:order 5 ;
    ] .
    
:DataSchemaShape a sh:NodeShape ;
    sh:targetClass jsonschema:DataSchema ;
    skos:definition """Metadata that describes the data format used. It can
          be used for validation."""^^rdf:HTML ;
    sh:closed false ;
    sh:order 1 ;
    sh:property [
        sh:path rdf:type ;
        skos:definition """Assignment of JSON-based data types compatible
                with JSON Schema (one of boolean, integer, number,
                string, object, array, or null)."""^^rdf:HTML ;
        sh:maxCount 1 ;
        sh:in (
            jsonschema:ObjectSchema
            jsonschema:ArraySchema
            jsonschema:StringSchema
            jsonschema:NumberSchema
            jsonschema:IntegerSchema
            jsonschema:BooleanSchema
            jsonschema:NullSchema
        );
        sh:order 5 ;
    ] ;
    sh:property [
        sh:path dcterms:title ;
        sh:order 1 ;
    ] ;
    sh:property [
        sh:path dcterms:description ;
        sh:order 3 ;
    ] ;
    sh:property [
        sh:path jsonschema:const ;
        skos:definition """Provides a constant value."""^^rdf:HTML ;
        sh:maxCount 1 ;
        sh:order 6 ;
    ] ;
    sh:property [
        sh:path schema:unitCode ;
        skos:definition """Provides unit information that is used, e.g.,
                in international science, engineering, and
                business."""^^rdf:HTML ;
        sh:order 6 ;
    ] ;
    sh:property [
        sh:path jsonschema:oneOf ;
        skos:definition """Used to ensure that the data is valid against
                one of the specified schemas in the array."""^^rdf:HTML ;
        sh:node :DataSchemaShape ;
        sh:order 8 ;
    ] ;
    sh:property [
        sh:path jsonschema:enum ;
        skos:definition """Restricted set of values provided as an
                array."""^^rdf:HTML ;
        sh:order 9 ;
    ] ;
    sh:property [
        sh:path jsonschema:readOnly ;
        skos:definition """Boolean value that is a hint to indicate
                whether a property interaction / value is read only
                (=true) or not (=false)."""^^rdf:HTML ;
        sh:datatype xsd:boolean ;
        sh:defaultValue false ;
        sh:maxCount 1 ;
        sh:order 10 ;
    ] ;
    sh:property [
        sh:path jsonschema:writeOnly ;
        skos:definition """Boolean value that is a hint to indicate
                whether a property interaction / value is write
                only (=true) or not (=false)."""^^rdf:HTML ;
        sh:datatype xsd:boolean ;
        sh:defaultValue false ;
        sh:maxCount 1 ;
        sh:order 11 ;
    ] ;
    sh:property [
        sh:path jsonschema:format ;
        skos:definition """Allows validation based on a format pattern
                such as "date-time", "email", "uri", etc. (Also see
                below.)"""^^rdf:HTML ;
        sh:datatype xsd:string ;
        sh:maxCount 1 ;
        sh:order 12 ;
    ] .

:ArraySchemaShape a sh:NodeShape ;
    sh:targetClass jsonschema:ArraySchema ;
    skos:definition """Metadata describing data of type <a href="#dfn-array" class="internalDFN" data-link-type="dfn">Array</a>. This
          <a href="#dfn-subclass" class="internalDFN" data-link-type="dfn">Subclass</a> is indicated by the
          value <code>array</code> assigned to <code>type</code> in
          <code>DataSchema</code> instances."""^^rdf:HTML ;
    sh:closed false ;
    sh:order 2 ;
    sh:property [
        sh:path jsonschema:items ;
        skos:definition """Used to define the characteristics of an
                array."""^^rdf:HTML ;
        sh:node :DataSchemaShape ;
        sh:order 1 ;
    ] ;
    sh:property [
        sh:path jsonschema:minItems ;
        skos:definition """Defines the minimum number of items that have
                to be in the array."""^^rdf:HTML ;
        sh:datatype xsd:unsignedInt ;
        sh:maxCount 1 ;
        sh:order 2 ;
    ] ;
    sh:property [
        sh:path jsonschema:maxItems ;
        skos:definition """Defines the maximum number of items that have
                to be in the array."""^^rdf:HTML ;
        sh:datatype xsd:unsignedInt ;
        sh:maxCount 1 ;
        sh:order 3 ;
    ] .
    
:BooleanSchemaShape a sh:NodeShape ;
    sh:targetClass jsonschema:BooleanSchema ;
    skos:definition """Metadata describing data of type <code>boolean</code>.
          This <a href="#dfn-subclass" class="internalDFN" data-link-type="dfn">Subclass</a> is indicated by the
          value <code>boolean</code> assigned to <code>type</code>
          in <code>DataSchema</code> instances."""^^rdf:HTML ;
    sh:closed false ;
    sh:order 3 .
    
:NumberSchemaShape a sh:NodeShape ;
    sh:targetClass jsonschema:NumberSchema ;
    skos:definition """Metadata describing data of type <code>number</code>.
          This <a href="#dfn-subclass" class="internalDFN" data-link-type="dfn">Subclass</a> is indicated by the
          value <code>number</code> assigned to <code>type</code>
          in <code>DataSchema</code> instances."""^^rdf:HTML ;
    sh:closed false ;
    sh:order 4 ;
    sh:property [
        sh:path jsonschema:minimum ;
        skos:definition """Specifies a minimum numeric value. Only
                applicable for associated number or integer
                types."""^^rdf:HTML ;
        sh:or (
            [ sh:datatype xsd:double ]
            [ sh:datatype xsd:integer ] # due to JSON-LD type coercion
        ) ;
        sh:maxCount 1 ;
        sh:order 1 ;
    ] ;
    sh:property [
        sh:path jsonschema:maximum ;
        skos:definition """Specifies a maximum numeric value. Only
                applicable for associated number or integer
                types."""^^rdf:HTML ;
        sh:or (
            [ sh:datatype xsd:double ]
            [ sh:datatype xsd:integer ] # due to JSON-LD type coercion
        ) ;
        sh:maxCount 1 ;
        sh:order 2 ;
    ] .
    
:IntegerSchemaShape a sh:NodeShape ;
    sh:targetClass jsonschema:IntegerSchema ;
    skos:definition """Metadata describing data of type <code>integer</code>.
          This <a href="#dfn-subclass" class="internalDFN" data-link-type="dfn">Subclass</a> is indicated by the
          value <code>integer</code> assigned to <code>type</code>
          in <code>DataSchema</code> instances."""^^rdf:HTML ;
    sh:closed false ;
    sh:order 5 ;
    sh:property [
        sh:path jsonschema:minimum ;
        skos:definition """Specifies a minimum numeric value. Only
                applicable for associated number or integer
                types."""^^rdf:HTML ;
        sh:datatype xsd:integer ;
        sh:maxCount 1 ;
        sh:order 1 ;
    ] ;
    sh:property [
        sh:path jsonschema:maximum ;
        skos:definition """Specifies a maximum numeric value. Only
                applicable for associated number or integer
                types."""^^rdf:HTML ;
        sh:datatype xsd:integer ;
        sh:maxCount 1 ;
        sh:order 2 ;
    ] .
    
:ObjectSchemaShape a sh:NodeShape ;
    sh:targetClass jsonschema:ObjectSchema ;
    skos:definition """Metadata describing data of type <code>object</code>.
          This <a href="#dfn-subclass" class="internalDFN" data-link-type="dfn">Subclass</a> is indicated by the
          value <code>object</code> assigned to <code>type</code>
          in <code>DataSchema</code> instances."""^^rdf:HTML ;
    sh:closed false ;
    sh:order 6 ;
    sh:property [
        sh:path jsonschema:properties ;
        skos:definition """Data schema nested definitions."""^^rdf:HTML ;
        sh:node :DataSchemaShape ;
        sh:order 1 ;
    ] ;
    sh:property [
        sh:path jsonschema:required ;
        skos:definition """Defines which members of the object type are
                mandatory."""^^rdf:HTML ;
        sh:datatype xsd:string ;
        sh:order 2 ;
    ] .

:StringSchemaShape a sh:NodeShape ;
    sh:targetClass jsonschema:StringSchema ;
    skos:definition """Metadata describing data of type <code>string</code>.
          This <a href="#dfn-subclass" class="internalDFN" data-link-type="dfn">Subclass</a> is indicated by the
          value <code>string</code> assigned to <code>type</code>
          in <code>DataSchema</code> instances."""^^rdf:HTML ;
    sh:closed false ;
    sh:order 7 .

:NullSchemaShape a sh:NodeShape ;
    sh:targetClass jsonschema:NullSchema ;
    skos:definition """Metadata describing data of type <code>null</code>.
          This <a href="#dfn-subclass" class="internalDFN" data-link-type="dfn">Subclass</a> is indicated by the
          value <code>null</code> assigned to <code>type</code> in
          <code>DataSchema</code> instances. This Subclass
          describes only one acceptable value, namely
          <code>null</code>. It can be used as part of a
          <code>oneOf</code> declaration, where it is used to
          indicate, that the data can also be
          <code>null</code>."""^^rdf:HTML ;
    sh:closed false ;
    sh:order 8 .
